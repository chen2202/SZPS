<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.w3.org/1999/xhtml">
<head>
    <th:block th:include="include :: header('基本资料发送')"/>
    <th:block th:include="include :: datetimepicker-css"/>
    <th:block th:include="include :: bootstrap-select-css" />

    <style>
        .main {
            text-align: center;
            width: 300px;
            height: 20px;
            position: absolute;
            left: 50%;
            top: 100%;
            transform: translate(-50%, -50%);
        }
    </style>

</head>
<body class="white-bg">
<div class="wrapper wrapper-content animated fadeInRight ibox-content">
    <form class="form-horizontal m" id="form-submit-edit" action="/event/send/sendmail" th:object="${eventAll}">

        <div class="form-group" style="text-align: center;">
            <h2><p>发送邮件</p></h2>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">事件名称：</label>
            <div class="col-sm-8">
                <input name="eventName" th:field="*{eventName}" class="form-control" type="text" readonly="readonly">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">事件地点：</label>
            <div class="col-sm-8">
                <input name="eventPlace" th:field="*{eventPlace}" class="form-control" type="text" readonly="readonly">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">事件时间：</label>
            <div class="col-sm-8">
                <input name="eventTime" th:value="${#dates.format(eventAll.eventTime, 'yyyy-MM-dd HH:mm:ss')}"
                       class="form-control" type="text"
                       readonly="readonly">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">事件内容：</label>
            <div class="col-sm-8">
                <textarea name="eventContent" class="form-control" style="resize: none; height: 150px"
                          readonly="readonly">[[*{eventContent}]]</textarea>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">事件属性：</label>
            <div class="col-sm-8">
                <input name="eventAttribute" th:field="*{eventAttribute}" class="form-control" type="text"
                       readonly="readonly">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">发送者：</label>
            <div class="col-sm-8">
                <input name="eventCreateuser" th:field="*{eventCreateuser}" class="form-control" type="text"
                       readonly="readonly">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">接收邮箱：</label>
            <div class="col-sm-8">

                <input type="hidden" class="form-control" name="channelsList" id="channelsList">
                <select name="eventEmail" id="email" class="form-control noselect2 selectpicker" data-none-selected-text="请选择" multiple required>
                    <optgroup label="--请选择邮箱--">
                        <option  th:each="list : ${emails}" th:if="${list.eventAttribute}==*{eventAttribute}" th:value="${list.eventEmail}"
                                th:text="${list.eventEmail}"></option>
                    </optgroup>
                </select>
<!--                <select  multiple="multiple" class="form-control m-b" >-->
<!--                    <optgroup>-->
<!--                       -->
<!--                    </optgroup>-->
<!--                </select>-->
            </div>
        </div>
        <div class="form-group main">
            <input type="submit"  onclick="doSubmit()"   class="btn btn-success" text="发送"/>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="/event/submit" class="btn btn-success">返回</a>
        </div>
    </form>
</div>
<th:block th:include="include :: footer"/>
<th:block th:include="include :: datetimepicker-js"/>
<th:block th:include="include :: bootstrap-select-js" />
<script type="text/javascript">
    function doSubmit(){
        var str=[];
        var obj = document.getElementById("email");
        for(var i=0;i<obj.options.length;i++){
            if(obj.options[i].selected){
                str.push(obj.options[i].value);// 收集选中项
            }
        }
        // alert(str);
        $("#channelsList").val(str);
    }

    var prefix = ctx + "event/send";
    $("#form-submit-edit").validate({
        focusCleanup: true
    });

    function submitHandler() {
        if ($.validate.form()) {
            $.operate.save(prefix + "/remove", $('#form-submit-edit').serialize());
        }
    }


</script>
</body>
</html>